{% extends 'base.html' %}
{% load static %}

{% block meta %}
<title>NobarPedia</title>
{% endblock meta %}

{% block content %}
{% include 'navbar.html' %}
<!-- Hero -->
<section class="relative min-h-screen flex flex-col items-center justify-center bg-[#1E1E1E] text-white px-6 overflow-hidden">

    <!-- Rectangle blur -->
    <div class="absolute bottom-0 left-0 w-full h-[130px] bg-[#0B6044]/50 blur-2xl "></div>

  <!-- Gambar latar -->
  <div class="hidden md:flex absolute inset-0 flex items-center justify-center pointer-events-none">
    <!-- kiri atas -->
    <img src="{% static 'image/homepage1.png' %}" 
         class="absolute top-20 -left-20 w-24 md:w-96 rounded-xl object-cover" alt="">
    <!-- kanan atas -->
    <img src="{% static 'image/homepage2.png' %}" 
         class="absolute top-20 -right-20 w-24 md:w-96 rounded-xl object-cover" alt="">
    <!-- kiri bawah -->
    <img src="{% static 'image/homepage2.png' %}" 
         class="absolute bottom-4 -left-40 w-24 md:w-96 rounded-xl object-cover" alt="">
    <!-- kanan bawah -->
    <img src="{% static 'image/homepage1.png' %}" 
         class="absolute bottom-4 -right-40 w-24 md:w-96 rounded-xl object-cover" alt="">
  </div>

    <!-- Desktop teks -->
  <div class="hidden md:block relative text-center max-w-xl z-10">
    <h1 class="text-5xl mb-4 tracking-wide">Welcome to Nobar<span class="text-green-500">Pedia</span></h1>
    <p class="text-gray-300 mb-6 text-base">
      Temukan tempat nobar terbaik di sekitarmu. Gabung komunitas sesama pecinta bola dan rasakan atmosfer pertandingan bersama!
    </p>
    <a href="#list-spots"
      class="bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-3 rounded-md transition">
      Cari tempat nobar
    </a>
  </div>

   <!-- Mobile teks -->
  <div class="flex flex-col items-center justify-center md:hidden z-10">
    <!-- Teks -->
    <h1 class="text-2xl mb-3 text-center tracking-wide">Welcome to Nobar<span class="text-green-500">Pedia</span></h1>
    <p class="text-gray-300 text-center mb-4 text-sm">
      Temukan tempat nobar terbaik di sekitarmu. Gabung komunitas sesama pecinta bola dan rasakan atmosfer pertandingan bersama!
    </p>
    <a href="#list-spots"
      class="bg-green-600 hover:bg-green-700 text-white font-medium px-6 py-3 rounded-md transition">
      Cari tempat nobar
    </a>


    <!-- Gambar Mobile -->
    <div class="relative w-full max-w-xl grid grid-cols-2 gap-0 mt-4">
    <!-- kiri -->
    <img 
        src="{% static 'image/homepage1.png' %}" 
        class="w-full h-32 object-cover rounded-xl -translate-x-8 md:-translate-x-20" 
        alt="">
    <!-- kanan -->
    <img 
        src="{% static 'image/homepage2.png' %}" 
        class="w-full h-32 object-cover rounded-xl translate-x-8 md:translate-x-20" 
        alt="">
    </div>

  </div>
</section>

<!-- List of spots -->
<section id="list-spots" class="relative flex flex-col items-center text-white bg-[#1E1E1E] py-20 w-full">
  <!-- Judul -->
  <h2 class="text-2xl md:text-3xl mb-8 tracking-wide text-center">
    Pick your spot!
  </h2>


{% if user.is_authenticated %}
  <!-- Tombol Desktop -->
  <div class="relative w-full max-w-3xl hidden md:flex justify-center mt-8 items-center">

    <a href="{% url 'homepage:create_spot' %}"
      class="absolute -left-48 bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition">
      + Add New Spot
    </a>

    <!-- Tombol tengah -->
    <div class="flex gap-4">
      <button id="filter-all"class="bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition">
        All Spot
      </button>
      <button id="filter-my"class="border border-green-600 text-white font-medium px-5 py-2 rounded-md hover:bg-green-600 transition">
        Your Spot
      </button>
    </div>
  </div>
  {% endif %}

  {% if user.is_authenticated %}
  <!-- Tombol Mobile -->
  <div class="w-full flex flex-col items-center gap-4 mt-8 md:hidden">
    
    <a href="{% url 'homepage:create_spot' %}"
      class="bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition w-[70%] text-center">
      + Add New Spot
    </a>

    <!-- Tombol tengah -->
    <div class="flex justify-center gap-4 w-[70%]">
      <a id="filter-all" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition">
        All Spot
      </a>
      <a id="filter-my" class="flex-1 border border-green-600 text-white font-medium px-5 py-2 rounded-md hover:bg-green-600 transition">
        Your Spot
      </a>
    </div>

   </div>
  {% endif %}

    <!-- Loading Spinner -->
  <div id="loading" class="bg-[#1E1E1E] text-center py-12 hidden">
    <svg class="animate-spin h-8 w-8 text-green-600 inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
    </svg>
    <p class="text-gray-400 mt-3">Loading spots...</p>
  </div>

  <!-- Error State -->
  <div id="error" class="hidden text-red-500 text-center py-12">Failed to load spots. Please try again later.</div>

  <!-- Empty State -->
  <div id="empty" class="hidden text-center py-16">
    <h3 class="text-xl mb-2">No spots found</h3>
    <p class="text-gray-400 mb-6">Be the first to create a new spot!</p>
    
  </div>

  <!-- Grid Container -->
  <div id="spot-grid" class="hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-12 w-[90%] md:w-[80%]"></div>


</section>

<!-- List of matches -->
<section id="list-match" class="relative flex flex-col items-center text-white bg-[#1E1E1E] py-20 w-full">
  <!-- Judul -->
  <h2 class="text-2xl md:text-3xl mb-8 tracking-wide text-center">
    View current matches, competitions, and even players!
  </h2>


{% if user.is_authenticated %}
  <!-- Tombol Desktop -->
  <div class="relative w-full max-w-3xl hidden md:flex justify-center mt-8 items-center">
    
    {% if perms.auth.view_user %}
        <button id="matchbtn" onclick="showCreateModal()"
          class="absolute -left-48 bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition">
          + Add New Match
        </button>
    {% endif %}

    <!-- Tombol tengah -->
    <div class="flex gap-4">
      <button id="filter-match"class="bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition" onclick="fetchMatchFromServer()">
        Matches
      </button>
      <button id="filter-competitions"class="border border-green-600 text-white font-medium px-5 py-2 rounded-md hover:bg-green-600 transition" onclick="fetchCompetitionFromServer()">
        Competitions
      </button>
      <button id="filter-players"class="border border-green-600 text-white font-medium px-5 py-2 rounded-md hover:bg-green-600 transition" onclick="fetchPlayerFromServer()">
        Players
      </button>
    </div>
  </div>
  {% endif %}

    <!-- Loading Spinner -->
  <div id="matchLoading" class="bg-[#1E1E1E] text-center py-12 hidden">
    <svg class="animate-spin h-8 w-8 text-green-600 inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
    </svg>
    <p class="text-gray-400 mt-3">Loading spots...</p>
  </div>

  <!-- Error State -->
  <div id="matchError" class="hidden text-red-500 text-center py-12">Failed to load spots. Please try again later.</div>

  <!-- Empty State -->
  <div id="matchEmpty" class="hidden text-center py-16">
    <h3 class="text-xl mb-2">No spots found</h3>
    <p class="text-gray-400 mb-6">Be the first to create a new spot!</p>
    
  </div>

  <!-- Grid Container -->
  <div id="matchGrid" class="hidden grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mt-12 w-[90%] md:w-[80%]"></div>


  {% include "create_modal.html" %}
</section>



<script>
const SPOT_API = "{% url 'homepage:json_spots' %}";
const CURRENT_USER_ID = "{{ user.id|default_if_none:'' }}";

const loading = document.getElementById('loading');
const error = document.getElementById('error');
const empty = document.getElementById('empty');
const grid = document.getElementById('spot-grid');

const allBtns = document.querySelectorAll('#filter-all');
const yourBtns = document.querySelectorAll('#filter-my');

let allSpots = [];
let activeFilter = 'all';

const matchLoading = document.getElementById('matchLoading');
const matchError = document.getElementById('matchError');
const matchEmpty = document.getElementById('matchEmpty');
const matchGrid = document.getElementById('matchGrid');
let activeMatchFilter = 'match'; // match or competition or player
let allMatch = [];
let isAdmin = "{{ perms.auth.view_user }}" === "True";

function formatDateTime(dateTimeString) {
    // Check if it's a date-only string (e.g., "2025-10-22")
    const isDateOnly = !dateTimeString.includes('T');

    let date;
    let options;

    if (isDateOnly) {
        // --- Handle Date-Only String ---

        // 1. To avoid timezone issues, we treat the date-only
        // string as UTC midnight by appending 'T00:00:00Z'.
        date = new Date(dateTimeString + 'T00:00:00Z');

        // 2. Define options for formatting the date only
        options = {
            year: 'numeric',  // e.g., 2025
            month: 'long',    // e.g., October
            day: 'numeric',     // e.g., 22
            timeZone: 'UTC'   // Interpret the date as UTC
        };

    } else {
        // --- Handle Full DateTime String ---

        // 1. Create a Date object from the full ISO string
        date = new Date(dateTimeString);

        // 2. Define options for formatting the date and time
        options = {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: 'numeric',
            minute: 'numeric',
            hour12: true,
            timeZone: 'UTC' // The 'Z' in the original string means UTC
        };
    }

    // 3. Format the date using the determined options
    return new Intl.DateTimeFormat('en-US', options).format(date);
}

function updateFilterButtonsAppearance() {
  allBtns.forEach(btn => {
    btn.className = activeFilter === 'all'
      ? 'flex-1 bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition'
      : 'flex-1 border border-green-600 text-white font-medium px-5 py-2 rounded-md hover:bg-green-600 transition';
  });

  yourBtns.forEach(btn => {
    btn.className = activeFilter === 'your'
      ? 'flex-1 bg-green-600 hover:bg-green-700 text-white font-medium px-5 py-2 rounded-md transition'
      : 'flex-1 border border-green-600 text-white font-medium px-5 py-2 rounded-md hover:bg-green-600 transition';
  });
}

function showSection({ loading: showLoading=false, error: showError=false, empty: showEmpty=false, grid: showGrid=false }) {
  loading.classList.toggle('hidden', !showLoading);
  error.classList.toggle('hidden', !showError);
  empty.classList.toggle('hidden', !showEmpty);
  grid.classList.toggle('hidden', !showGrid);
}

function addMatchItem() {
    if (activeMatchFilter === "match") {

        fetchMatchFromServer();
    } else if (activeMatchFilter === "player") {

        fetchPlayerFromServer();
    } else { // competition

        fetchCompetitionFromServer();
    }
    fet
}

function renderMatches() {
    matchGrid.innerHTML = '';
  allMatch.forEach(s => matchGrid.appendChild(buildMatchCard(s)));
}

function buildMatchCard(item) {
    const div = document.createElement('div');
    div.className = "bg-stone-800 rounded-lg p-2";
    if (activeMatchFilter === "match") {
        const name = DOMPurify.sanitize(item.competition[0].fields.name);
        const begin_datetime = DOMPurify.sanitize(formatDateTime(item.fields.begin_datetime));
        const end_datetime = DOMPurify.sanitize(formatDateTime(item.fields.end_datetime));
        const first_logo = DOMPurify.sanitize(item.players[0][0].fields.logo);
        const second_logo = DOMPurify.sanitize(item.players[1][0].fields.logo);
        const first_player_name = DOMPurify.sanitize(item.players[0][0].fields.name);
        const second_player_name = DOMPurify.sanitize(item.players[1][0].fields.name);

        let first_logo_html = "";
        let second_logo_html = "";

        if (first_logo.length > 0) {
            first_logo_html = `
                <img width="400"
                     height="400"
                     src="${first_logo}">
            `
        }

        if (second_logo.length > 0) {
            second_logo_html = `
                <img width="400"
                     height="400"
                     src="${second_logo}">
            `
        }

        const matchCard = `
            <div class="flex flex-col justify-center w-full">
                <h3 class="text-lg font-medium text-center text-white mb-2"> ${name} </h3>
                <p class="text-sm font-small text-center text-white">${begin_datetime} - ${end_datetime}</p>
            </div>
            <div class="grid grid-cols-5 w-full items-center">
                <div class="col-span-2 w-full justify-center text-center text-white">
                    <a href="" class="text-white transition-all hover:text-green-600">
                        ${first_logo_html}
                        ${first_player_name}
                    </a>
                </div>
                <h3 class="select-none text-center text-white text-3xl font-medium">vs</h3>
                <div class="col-span-2 w-full justify-center text-center text-white">
                    <a href="" class="text-white transition-all hover:text-green-600">
                        ${second_logo_html}
                        ${second_player_name}
                    </a>
                </div>
            </div>
        `
        div.innerHTML = matchCard;
    } else if (activeMatchFilter === "player") {
        const name = DOMPurify.sanitize(item.fields.name);
        const logo = DOMPurify.sanitize(item.fields.logo);
        const established_date = formatDateTime(item.fields.established_date);

        let logo_html = "";
        let defunct_html = ""

        if (logo.length > 0) {
            logo_html = `
                <img width="400"
                     height="400"
                     src="${logo}">
            `
        }

        if (item.fields.is_defunct) {
            defunct_html = '<p class="text-sm font-small text-red">Defunct</p>';
        }

        const matchCard = `
            <h3 class="text-lg font-medium text-center text-white mb-2"> ${name} </h3>
            <p class="text-sm font-small text-center text-white">${established_date}</p>
            ${defunct_html}
            <div class="grid w-full items-center">
                ${logo_html}    
            </div>
        `
        div.innerHTML = matchCard;

    } else { // competition

        const name = DOMPurify.sanitize(item.fields.name);
        const begin_date = DOMPurify.sanitize(formatDateTime(item.fields.begin_date));
        const end_date = DOMPurify.sanitize(formatDateTime(item.fields.end_date));
        const logo = DOMPurify.sanitize(item.fields.logo);

        let logo_html = "";

        if (logo.length > 0) {
            logo_html = `
                <img width="400"
                     height="400"
                     src="${logo}">
            `
        }

        const matchCard = `
        <div class="bg-stone-800 rounded-lg p-2">
            <h3 class="text-lg font-medium text-center text-white mb-2"> ${name} </h3>
            <p class="text-sm font-small text-center text-white">${begin_date} - ${end_date}</p>
            <div class="grid grid-cols-5 w-full items-center">
                ${logo_html}
            </div>
        </div>            
        `
        div.innerHTML = matchCard;

    }
    return div;
}

function safeFormatDate(dateStr) {
  if (!dateStr) return '';
  const d = new Date(dateStr);
  if (isNaN(d.getTime())) return dateStr;
  return d.toLocaleDateString('en-US', { month:'short', day:'2-digit' });
}


function buildSpotCard(spot) {
    const div = document.createElement('div');
    div.className = "bg-white rounded-xl shadow hover:shadow-lg transition overflow-hidden text-gray-900 flex flex-col";

    const linkDetail = `{% url 'review:show_reviews' '00000000-0000-0000-0000-000000000000' %}`.replace('00000000-0000-0000-0000-000000000000', spot.id);
    const linkEdit = `{% url 'homepage:edit_spot' '00000000-0000-0000-0000-000000000000' %}`.replace('00000000-0000-0000-0000-000000000000', spot.id);
    const linkDelete = `{% url 'homepage:delete_spot' '00000000-0000-0000-0000-000000000000' %}`.replace('00000000-0000-0000-0000-000000000000', spot.id);

    const formattedTime = spot.time ? spot.time.split(':').slice(0, 2).join(':') : '';

    let editdeleteButtons = '';
    if (CURRENT_USER_ID && String(CURRENT_USER_ID) !== '' && String(spot.host_id) !== '' && String(CURRENT_USER_ID) === String(spot.host_id)) {
      editdeleteButtons =  `
      <div class="flex gap-2 ml-3">
        <a href="${linkEdit}" class="text-green-600 hover:text-green-700 text-sm font-medium py-2 px-1">Edit</a>
        <a href="${linkDelete}" 
            onclick="return confirm('Apakah Anda yakin ingin menghapus Spot ini?')"
            class="text-red-600 hover:text-red-700 text-sm font-medium py-2 px-1">Hapus</a>
      </div>
    `;
    }

    div.innerHTML = `
        <div class="p-2"> 
            <div class="aspect-[16/9] overflow-hidden rounded-lg">
                <img src="${spot.thumbnail || 'https://placehold.co/600x400'}" class="w-full h-full object-cover" alt="thumbnail">
            </div>
        </div>

        <div class="p-4 flex flex-col flex-1">
            <div class="mb-3">
                <span class="bg-white text-[#2CAC5C] text-sm font-medium me-2 px-2.5 py-0.5 rounded-full border border-[#2CAC5C]">${spot.home_team || ''} vs ${spot.away_team || ''}</span>
            </div>

            <div class="flex justify-between items-start mb-2">
                <h3 class=" headline text-lg leading-tight flex-1 text-black truncate">${spot.name || ''}</h3>
                <p class="footnote text-xs text-gray-500 whitespace-nowrap ml-4">${safeFormatDate(spot.date)}${formattedTime ? ' | ' + formattedTime : ''}</p>
            </div>
            <p class="footnote text-sm text-gray-500 mb-4">${spot.city || ''}</p>
            
            <div class="mt-auto flex items-center pt-2">
               <a href="${linkDetail}" class="flex-1 bg-green-600 hover:bg-green-700 text-white text-base font-medium px-4 py-2 rounded-md text-center">Detail</a>
                    ${editdeleteButtons}
            </div>

        </div>
    `;
    return div;
}

function renderSpots(spots) {
  grid.innerHTML = '';
  spots.forEach(s => grid.appendChild(buildSpotCard(s)));
}

async function fetchMatchFromServer() {
    try {
        matchLoading.classList.remove("hidden");
        matchGrid.classList.add("hidden");
        matchEmpty.classList.add('hidden');
        const response = await fetch("{% url 'match:api_read_all_match' %}", {
            headers: { 'Accept': 'application/json' },
        });
        if (!response.ok) {
            throw new Error('Failed to fetch data from server');
        }
        const matchData = await response.json();
        allMatch = JSON.parse(matchData || []);
        console.log(allMatch);
        for (const item of allMatch) {
            item.competition = JSON.parse(await fetchCompetitionIdFromServer(item.fields.competition));
            const p_1 = await fetchPlayerIdFromServer(item.fields.players[0]);
            const p_2 = await fetchPlayerIdFromServer(item.fields.players[1]);
            item.players = [JSON.parse(p_1), JSON.parse(p_2)];
        }
        console.log(allMatch);
        activeMatchFilter = "match";
        renderMatches();
        matchLoading.classList.add("hidden");
        matchGrid.classList.remove("hidden");
        if (allMatch.length == 0) {
            matchEmpty.classList.remove('hidden');
        }
    } catch (error) {
        console.error('Error loading', error);
    }
}

async function fetchCompetitionIdFromServer(id) {
    try {
       

        const link = `{% url 'match:api_read_competition' '00000000-0000-0000-0000-000000000000' %}`.replace('00000000-0000-0000-0000-000000000000', id);
        const response = await fetch(link, {
            headers: { 'Accept': 'application/json' },
        });

        if (!response.ok) {
            throw new Error('Failed to fetch data from server');
        }
        const data = await response.json();
        return data || [];
    } catch (error) {
        console.error('Error loading', error);
    }
}

 async function fetchPlayerIdFromServer(id) {
    try {
        const link = `{% url 'match:api_read_player' '00000000-0000-0000-0000-000000000000' %}`.replace('00000000-0000-0000-0000-000000000000', id);
        const response = await fetch(link, {
            headers: { 'Accept': 'application/json' },
        });
        if (!response.ok) {
            throw new Error('Failed to fetch data from server');
        }
        const data = await response.json();
        return data || [];
    } catch (error) {
        console.error('Error loading', error);
    }
}

async function fetchCompetitionFromServer() {
    try {
        matchLoading.classList.remove("hidden");
        matchGrid.classList.add("hidden");
        matchEmpty.classList.add('hidden');
        const response = await fetch("{% url 'match:api_read_all_competition' %}", {
            headers: { 'Accept': 'application/json' },
        });

        if (!response.ok) {
            throw new Error('Failed to fetch data from server');
        }
        const matchData = await response.json();
        allMatch = JSON.parse(matchData || []);
        activeMatchFilter = "competition";
        renderMatches();
        matchLoading.classList.add("hidden");
        matchGrid.classList.remove("hidden");
        if (allMatch.length == 0) {
            matchEmpty.classList.remove('hidden');
        }
    } catch (error) {
        console.error('Error loading', error);
    }
}

async function fetchPlayerFromServer() {
    try {
        matchLoading.classList.remove("hidden");
        matchGrid.classList.add("hidden");
        matchEmpty.classList.add('hidden');

        const response = await fetch("{% url 'match:api_read_all_player' %}", {
            headers: { 'Accept': 'application/json' },
        });

        if (!response.ok) {
            throw new Error('Failed to fetch data from server');
        }
        const matchData = await response.json();
        allMatch = JSON.parse(matchData || []);
        activeMatchFilter = "player";
        renderMatches();
        matchLoading.classList.add("hidden");
        matchGrid.classList.remove("hidden");
        if (allMatch.length == 0) {
            matchEmpty.classList.remove('hidden');
        }

    } catch (error) {
        console.error('Error loading', error);
    }
}


function filterSpots() {
  updateFilterButtonsAppearance();

  const filtered = activeFilter === 'all'
    ? allSpots
    : allSpots.filter(s => {
        if (!CURRENT_USER_ID || CURRENT_USER_ID === '') return false;
        return String(s.host_id) === String(CURRENT_USER_ID);
      });

  if (filtered.length === 0) {
    showSection({ empty: true });
  } else {
    renderSpots(filtered);
    showSection({ grid: true });
  }
}

async function fetchSpots() {
  try {
    showSection({ loading: true });
    const res = await fetch(SPOT_API);
    if (!res.ok) throw new Error("Failed to fetch");
    const data = await res.json();

    allSpots = (Array.isArray(data) ? data : []).map(item => {
      const fields = item.fields || item;
      return {
        id: item.pk || item.id || fields.id || '',
        name: fields.name || fields.title || '',
        thumbnail: fields.thumbnail || fields.image || '',
        home_team: fields.home_team || fields.homeTeam || '',
        away_team: fields.away_team || fields.awayTeam || '',
        date: fields.date || '',
        time: fields.time || fields.hour || '',
        city: fields.city || '',
        address: fields.address || '',
        host_id: typeof fields.host !== 'undefined' ? fields.host : (fields.host_id || '')
      };
    });

    filterSpots();
  } catch (e) {
    console.error(e);
    showSection({ error: true });
  }
}

allBtns.forEach(btn => {
  btn.addEventListener('click', (e) => {
    e.preventDefault();
    activeFilter = 'all';
    fetchSpots();
  });
});

yourBtns.forEach(btn => {
  btn.addEventListener('click', (e) => {
    e.preventDefault();
    activeFilter = 'your';
    fetchSpots();
  });
});

document.addEventListener('DOMContentLoaded', fetchSpots);
document.addEventListener('DOMContentLoaded', fetchMatchFromServer);
</script>



{% endblock content %}
